<?php

function oosdmodule_menu(){
	$items['hire_equipment'] = array(
		'title' =>'Hire Equipment',
		'page callback' => 'bw_hire_equipment_page',
		'access arguments' => array('access content'),
		'type' => MENU_NORMAL_ITEM,
	);
	
	$items['equipment'] = array(
		'title' =>'Manage Equipment',
		'page callback' => 'bw_equipment_page',
		'access arguments' => array('access content'),
		'type' => MENU_NORMAL_ITEM,
	);
    return $items;
}

// TODO refactor same as bw_equipment_page
function bw_hire_equipment_page(){
    module_load_include('inc', 'oosdmodule', 'hire_equipment_page');
    
    $method = bw_get_method();
    
    if($method){ return $method(); }
    
    return bw_list_available_equipment(BWEquipment::getAll());
}

function bw_equipment_page(){
    module_load_include('inc', 'oosdmodule', 'equipment_page');
    module_load_include('inc', 'oosdmodule', 'equipment');
    
    $method = bw_get_method();
    
    if($method){ return $method(); }
    
    return bw_list_equipment(BWEquipment::getAll());
}

function bw_get_method(){
    $method = false;
    $action = $_REQUEST['action'];
    
    if($action){
        $method = "bw_".strtolower($_SERVER['REQUEST_METHOD']) ."_$action";
    }
    return $method;
}

// who can use this module?
function oosdmodule_perm() {
    return array('Hire', 'Manage');
}


// FIXME delete after db is ready
class BWEquipment {
	function getAll(){
		return array(
			array("id" => 1, "category" => "tent", "name" => "Tent 3 man", "description" => "good for 3 man", "price" => 10 ),
			array("id" => 2, "category" => "tent", "name" => "Tent 6 man", "description" => "good for 6 man", "price" => 20 ),
			array("id" => 3, "category" => "backpack", "name" => "backpack", "description" => "a backpack", "price" => 2 ),
			array("id" => 4, "category" => "shoes", "name" => "hiking shoes", "description" => "good for hiking", "price" => 5 ),
			);
	}
}
?>